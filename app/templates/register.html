<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jusdots</title> 
    <link rel="stylesheet" href="{% static 'css/login.css' %}">
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
<!-- Ionic Icon -->
<script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
<script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

<!-- bootstrap Icon  -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.2/font/bootstrap-icons.css">

<!-- Google Icon -->
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,200,0,0" />

    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>
    <script  src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous">
    </script>
</head>
<body>
    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand" href="{% url 'index' %}" style="color: #009eff;">
                <img src="{% static 'img/logo1.png'%}" alt="Logo"  height="60" width="60" class="d-inline-block align-text-center">
                <span style="vertical-align: bottom; font-size:26px;">Jusdots</span>
            </a>
        </div>
    </nav>
    <div class="container"  >
        <div class="login">
            <h3>Register New Account</h3>
            <center>  
                <div class="container" >
                {% if messages %}
                        <div class ="messages" style="width: 300px;">
            
                    {% for message in messages  %}
                            <div class="alert alert-danger" role="alert">
                                <strong style="font-size: 18px;">! {{message}}</strong> 
                            </div>
            
                    {% endfor %}
            
                        </div>
                        
                {% endif %}
                </div> 
            </center> 
            <p>Already have an account click <a href="{% url 'login' %}">login</a></p>
            <!-- {% comment %} <form method="POST">
                {% csrf_token %}
                    {{ registration_form }}
                <button type="submit" class="btn ">Create Account</button>
            </form> {% endcomment %} -->

            <form method="POST" class="post-form" > 
                {% csrf_token %}
                <div class="inputWithIcon">
                    <!-- <input type="email" placeholder="E-Mail"> -->
                    <input type="email" placeholder="Email" name="email" id="id_email">
                    <span class="material-symbols-outlined">email</span>
                </div>
                <div class="inputWithIcon" >
                    <input type="text" placeholder="Username" name="username" id="id_username">
                    <span class="material-symbols-outlined">account_circle</span>
                </div> 
                <div class="inputWithIcon">
                    <input type="password" id="id_password1" name="password1" placeholder="Password" onkeyup="validatepass(this)">
                    <span class="material-symbols-outlined">lock</span>
                </div>
                <ul class="helpertext">
                    <input class="inputRadio" id="ir1" type="radio" disabled>   At Least 8 Characters Long <br>
                    <!-- <input class="inputRadio" id="ir2" type="radio" disabled>   Can't be Entirely Numeric<br> -->
                    <input class="inputRadio" id="ir3" type="radio" disabled>   Must not be similar to Username<br>
                    <!-- <input class="inputRadio" id="ir4" type="radio" disabled>   Must not be commonly used Password<br> -->
                    <input class="inputRadio" id="ir4" type="radio" disabled>   Must Contain 1 Special Character, a number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and an Uppercase letter
                </ul> 
                <div class="inputWithIcon">
                    <input type="password" id="id_password2" name="password2" placeholder="Confirm Password"onkeyup="validate_password()">
                    <span class="material-symbols-outlined">lock</span>
                    <span style="margin-left: 2%;" id="wrong_pass_alert"></span>
                </div>
                
                <button type="submit" class="btn "  onclick="wrong_pass_alert()">Create Account</button>
            </form>
            <p class="terms">By proceeding you are accepting terms of service and privacy policy</p> 
        </div>
    </div>
   
    <script>
        function checkPassword(str)
        {
            var re = /^(?=.*\d)(?=.*[!@#$%^&*])(?=.*[A-Z]).{8,}$/;
            return re.test(str);
        }

        function validatepass(e){
            var username = document.getElementById('id_username').value;
            var password = document.getElementById('id_password1').value;
            pass = checkPassword(password)
            console.log(pass)
            if(e.key === 'Backspace'){ 
                document.getElementById('ir1').checked  = false;
                document.getElementById('ir3').checked  = false;
                document.getElementById('ir4').checked  = false;
            }
            if (pass === true){
                document.getElementById('ir1').checked  = true;
                document.getElementById('ir4').checked  = true; 
            } 
            else{ 
                document.getElementById('ir1').checked  = false;
                document.getElementById('ir4').checked  = false;
            }
            var perc=Math.round(similarity(username,password)*10000)/100; 
            if ( pass === true && perc < 60){
                document.getElementById('ir3').checked  = true; 
            } 
            else{
                document.getElementById('ir3').checked  = false;

            }  
        }

        function similarity(username,password){
            var longer = username;
                var shorter = password;
                if (username.length < password.length) {
                  longer = password;
                  shorter = username;
                }
                var longerLength = longer.length;
                if (longerLength === 0) {
                    sim = 1.0;
                }
                return( longerLength - editDistance(longer, shorter)) / parseFloat(longerLength);
        }

        function editDistance(s1, s2) {
            s1 = s1.toLowerCase();
            s2 = s2.toLowerCase();
          
            var costs = new Array();
            for (var i = 0; i <= s1.length; i++) {
              var lastValue = i;
              for (var j = 0; j <= s2.length; j++) {
                if (i == 0)
                  costs[j] = j;
                else {
                  if (j > 0) {
                    var newValue = costs[j - 1];
                    if (s1.charAt(i - 1) != s2.charAt(j - 1))
                      newValue = Math.min(Math.min(newValue, lastValue),
                        costs[j]) + 1;
                    costs[j - 1] = lastValue;
                    lastValue = newValue;
                  }
                }
              }
              if (i > 0)
                costs[s2.length] = lastValue;
            }
            return costs[s2.length];
          } 
    </script>
    <script>
        function validate_password() {  
            var pass = document.getElementById('id_password1').value;
            var confirm_pass = document.getElementById('id_password2').value;
            if (pass != confirm_pass) {
                document.getElementById('wrong_pass_alert').style.color = 'red';
                document.getElementById('wrong_pass_alert').innerHTML
                  = 'â˜’ Use same password';
                document.getElementById('create').disabled = true;
                document.getElementById('create').style.opacity = (0.4);
            } else {
                document.getElementById('wrong_pass_alert').style.color = 'green';
                document.getElementById('wrong_pass_alert').innerHTML =
                    'ðŸ—¹ Password Matched';
                document.getElementById('create').disabled = false;
                document.getElementById('create').style.opacity = (1);
            }
           }
           
           function wrong_pass_alert() {
            if (document.getElementById('Password').value != document.getElementById('Confirm_Password').value) {
                alert("Password not Matched");
            } 
           }
    </script>
</body>
</html>